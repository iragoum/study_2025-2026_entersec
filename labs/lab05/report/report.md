---
## Front matter
title: "Лабораторная работа № 5"
subtitle: "Модель эпидемии (SIR)"
author: "Мугари Абдеррахим"

## Generic options
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
lot: true # List of tables
fontsize: 13pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
    - spelling=modern
    - babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: Times New Roman
romanfont: Times New Roman
sansfont: Times New Roman
monofont: "Courier New"
mathfont: STIX Two Math
mainfontoptions: Scale=1.0
romanfontoptions: Scale=1.0
sansfontoptions: Scale=1.0
monofontoptions: Scale=1.0,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{listings}
  - \renewcommand{\lstlistingname}{Листинг}
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
  - \renewcommand{\familydefault}{\rmdefault} # Ensure Times New Roman for main text
  - \lstset{basicstyle=\ttfamily\fontsize{10pt}{10pt}\selectfont,lineskip=-1pt} 

---

# Цель работы

- Целью данной лабораторной работы является изучение и моделирование распространения инфекционных заболеваний с использованием математической модели **SIR**. В рамках работы необходимо:

    - Построить базовую модель SIR в программных средах **Xcos** и **OpenModelica**.
    - Исследовать динамику эпидемии при заданных параметрах.
    - Модифицировать модель, добавив процессы рождаемости и смертности.
    - Провести анализ влияния параметров на поведение модели.
    
    
# Теоретическая часть

Модель SIR была предложена в 1927 году учёными W. O. Kermack и **A. G. McKendrick**. Она описывает динамику численности населения в условиях распространения инфекционного заболевания.

В данной модели рассматриваются три группы населения:

- **S (susceptible, восприимчивые)** — здоровые, но уязвимые особи, которые могут заразиться.

- **I (infected, инфицированные)** — заражённые и распространяющие заболевание.

- **R (recovered, выздоровевшие)** — особи, переставшие быть источником инфекции (выздоровевшие или умершие).


Общее число особей остаётся постоянным:
$$
N = S + I + R.
$$

## Система дифференциальных уравнений модели SIR:

$$
\begin{cases}
\frac{dS}{dt} = - \beta S I,\\
\frac{dI}{dt} = \beta S I - \nu I,\\
\frac{dR}{dt} = \nu I.
\end{cases}
$$

где:

- коэффициент заражения,

- коэффициент выздоровления.

Данная система описывает динамику заражения и выздоровления в популяции


# Практическая часть

## Открытие Scilab и Xcos

Была запущена среда Scilab, затем открыт Xcos для создания модели.(рис. [-@fig:001]).

![Открытие Scilab и Xcos](image/1.png){#fig:001 width=70%}

## Задание параметров модели

Заданы значения:

\beta = 1, \quad \nu = 0.3. (рис. [-@fig:002]).

![Задание параметров модели](image/2.png){#fig:002 width=70%}


## Построение модели в Xcos

Модель была собрана с использованием следующих блоков: (рис. [-@fig:003]).

- **CLOCK_c** — для управления временем моделирования.

- **INTEGRAL_m** — для интегрирования уравнений.

- **GAINBLK_f** — для задания коэффициентов  и .

- **SUMMATION** — для суммирования потоков.

- **PROD_f** — для вычисления произведений.

- **MUX** — для объединения данных на один график.

- **CSCOPE** — для визуализации графиков.


![Построение модели в Xcos](image/3.png){#fig:003 width=70%}


Начальные условия были установлены:
$$
S(0)=0.999
I(0)=0.001
R(0)=0
$$
## Запуск графика модели SIR

![Запуск графика модели SIR](image/4.png){#fig:004 width=70%}

При запуске модели были получены три графика: (рис. [-@fig:004]).

- График S(t) (синим) показывает уменьшение восприимчивых особей.

- График I(t) (зелёным) показывает рост заражённых, достигая максимума.

- График R(t) (красным) показывает увеличение выздоровевших.

Пик числа заражённых i(t) показывает максимальное количество больных в популяции одновременно. Это важный показатель, который может быть использован для оценки нагрузки на систему здравоохранения во время эпидемии.



## Реализация модели в Modelica


- Далее я использовал блок "Modelica generic" в Xcos для реализации модели SIR. Это оказалось проще, так как код на языке Modelica более компактный и читаемый (рис. [-@fig:005]).

![Реализация модели в Modelica](image/7.png){#fig:005 width=70%}

- здесь я ввел значения констант и выходных переменных, которые мы имеем в модели (рис. [-@fig:006]).

![Реализация модели в Modelica](image/5.png){#fig:006 width=70%}

- Для реализации модели использовался Modelica Generic Block. Код:(рис. [-@fig:007]).

![Реализация модели в Modelica](image/6.png){#fig:007 width=70%}

Я запустил симуляцию с использованием блока Modelica и получил те же графики, что и в шаге 4. Это ожидаемо, так как параметры и уравнения остались неизменными, что подтверждает корректность реализации модели. (рис. [-@fig:008]).

![Сравнение графиков](image/8.png){#fig:008 width=70%}

## Решение упражнения с добавлением рождаемости

Для модификации модели было необходимо добавить процессы рождаемости и смертности. Новая система дифференциальных уравнений выглядит следующим образом:

$$
\begin{cases}
\frac{dS}{dt} = - \beta S I + \mu (N - S),\\
\frac{dI}{dt} = \beta S I - \nu I - \mu I,\\
\frac{dR}{dt} = \nu I - \mu R.
\end{cases}
$$


μ — коэффициент рождаемости и смертности, который учитывает приток новых уязвимых и естественную убыль населения во всех группах.
N — общая популяция, принятая равной 1 (нормированная).

- Эта модификация делает модель более реалистичной, так как в реальной жизни популяция не остаётся полностью замкнутой, а обновляется за счёт рождений и смертей.


## Построение модифицированной модели в Xcos

Я построил новую модель в Xcos, добавив блоки для учёта $\mu$. Уравнения теперь включают дополнительные члены:

- Для \( s(t) \): 
  $$ 
  \frac{ds}{dt} = \dots + \mu (N - s(t)) 
  $$

- Для \( i(t) \): 
  $$ 
  \frac{di}{dt} = \dots - \mu i(t) 
  $$

- Для \( r(t) \): 
  $$ 
  \frac{dr}{dt} = \dots - \mu r(t) 
  $$ 

как показано в (рис. [-@fig:009]).

![Построение модифицированной модели в Xcos](image/9.png){#fig:009 width=70%}


## Анализ графиков для модифицированной модели

- Сначала я установил μ=0, чтобы проверить, совпадает ли модифицированная модель с базовой SIR. Графики были идентичны тем, что получены в шагах 4 и 6, что подтвердило правильность построения модели, так как при μ=0 рождаемость и смертность отсутствуют (рис. [-@fig:010]).

![Анализ графиков для модифицированной модели](image/10.png){#fig:010 width=70%}

затем я изменил μ=0.2 и запустил симуляцию. На графиках видно (рис. [-@fig:011])

- Число уязвимых s(t) стабилизируется на определённом уровне, а не падает до нуля, из-за притока новых уязвимых за счёт рождаемости.
- Число заражённых i(t) также не исчезает, а остаётся на постоянном уровне, что указывает на эндемическое состояние.

![Анализ графиков для модифицированной модели](image/12.png){#fig:011 width=70%}


## Построение модифицированной модели с помощью Modelica

- использовали блок "Modelica generic" для реализации модифицированной модели. Код был обновлён следующим образом (рис. [-@fig:012])

![Построение модифицированной модели с помощью Modelica](image/2121){#fig:012 width=70%}

- здесь я ввел значения констант и выходных переменных, которые мы имеем в модели (рис. [-@fig:013]).

![Построение модифицированной модели с помощью Modelica](image/13.png){#fig:013 width=70%}

### Код: (рис. [-@fig:014]).

![Код модифицированной модели](image/14.png){#fig:014 width=70%}

## Визуализация графиков для модифицированной модели

- Я запустил симуляцию и получил графики, аналогичные тем, что были ранее. Это подтвердило, что модель работает корректно в обоих подходах (блоки и Modelica) (рис. [-@fig:015]).

![Визуализация графиков для модифицированной модели](image/15.png){#fig:015 width=70%}

## Моделирование в OpenModelica (OMEdit)

- Я перенёс модифицированную модель в среду OpenModelica (OMEdit) (рис. [-@fig:016]).

![Моделирование в OpenModelica (OMEdit)](image/16.png){#fig:016 width=70%}

- провёл симуляцию с μ=0.2. Графики были визуализированы и показали ту же динамику, что и в Xcos, что подтверждает согласованность результатов  (рис. [-@fig:017]).

![Визуализация графиков для модифицированной модели](image/17.png){#fig:017 width=70%}


## Исследование различных случаев (β=10,μ=0.7)

- Я провёл эксперимент, установив β=10 и μ=0.7. На графиках видно:

- Число уязвимых s(t) падает практически мгновенно из-за высокого коэффициента заражения.
- Число заражённых i(t) резко возрастает, но благодаря высокому μ=0.7 (быстрая убыль населения) и выздоровлению эпидемия затухает примерно через 5 дней (рис. [-@fig:018]).

![Исследование различных случаев (β=10,μ=0.7)](image/18.png){#fig:018 width=70%}


## Исследование случая с ν=0.9

- Я установил nu=0.9, что соответствует очень быстрому выздоровлению. В этом случае эпидемия не развивается:

- Число уязвимых s(t) остаётся близким к начальному значению (0.999) и постепенно приближается к 1.
- Число заражённых i(t)i(t) быстро падает до нуля, так как люди моментально выздоравливают.(рис. [-@fig:019])

![Исследование случая с ν=0.9](image/19.png){#fig:019 width=70%}



# Выводы

В ходе лабораторной работы была успешно реализована и исследована модель SIR для описания динамики распространения эпидемии. Были выполнены следующие задачи:

- Построена базовая модель SIR в Xcos с использованием блоков и через язык Modelica, а также проведена её симуляция.
- Модифицирована модель с учётом рождаемости и смертности, что позволило наблюдать переход к эндемическому состоянию.
- Исследованы различные случаи с изменением параметров ββ, νν и μμ, что продемонстрировало их влияние на динамику эпидемии.

Полученные результаты показывают, как математические модели могут быть применены для анализа эпидемиологических процессов и подчёркивают важность учёта демографических факторов для долгосрочных прогнозов.

Подробнее см. в [@scilab_xcos_en; @modelica_spec_en; @openmodelica_manual_en].
    
# Список литературы{.unnumbered}

::: {#refs}
:::
